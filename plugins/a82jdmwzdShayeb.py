#TeleGram: @ADIL721
import base64
exec(base64.b64decode('IyEvdXNyL2Jpbi9lbnYgcHl0aG9uMwojIENvcHlyaWdodCAoQykgQHN1YmlucHMKIyBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTogeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQojIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEFmZmVybyBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQojIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIGVpdGhlciB2ZXJzaW9uIDMgb2YgdGhlIExpY2Vuc2UsIG9yCiMgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4KCiMgVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCiMgYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKIyBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlCiMgR05VIEFmZmVybyBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCgojIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBBZmZlcm8gR2VuZXJhbCBQdWJsaWMgTGljZW5zZQojIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtLiAgSWYgbm90LCBzZWUgPGh0dHBzOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4KZnJvbSB1dGlscyBpbXBvcnQgTE9HR0VSCmltcG9ydCByZQppbXBvcnQgY2FsZW5kYXIKZnJvbSBkYXRldGltZSBpbXBvcnQgZGF0ZXRpbWUKZnJvbSBjb250ZXh0bGliIGltcG9ydCBzdXBwcmVzcwppbXBvcnQgcHl0egpmcm9tIGNvbmZpZyBpbXBvcnQgQ29uZmlnCmZyb20gUFROIGltcG9ydCBwYXJzZQpmcm9tIHlvdXR1YmVfc2VhcmNoIGltcG9ydCBZb3V0dWJlU2VhcmNoCmZyb20geXRfZGxwIGltcG9ydCBZb3V0dWJlREwKCmZyb20gcHlyb2dyYW0gaW1wb3J0KAogICAgQ2xpZW50LCAKICAgIGZpbHRlcnMKICAgICkKZnJvbSBweXJvZ3JhbS50eXBlcyBpbXBvcnQgKAogICAgSW5saW5lS2V5Ym9hcmRCdXR0b24sIAogICAgSW5saW5lS2V5Ym9hcmRNYXJrdXAKKQpmcm9tIHV0aWxzIGltcG9ydCAoCiAgICBkZWxldGVfbWVzc2FnZXMsCiAgICBpc19hZG1pbiwKICAgIHN5bmNfdG9fZGIsCiAgICBpc19hdWRpbywKICAgIGNoYXRfZmlsdGVyLAogICAgc2NoZWR1bGVyLAogICAgaXNfeXRkbF9zdXBwb3J0ZWQKKQoKZnJvbSBweXJvZ3JhbS50eXBlcyBpbXBvcnQgKAogICAgSW5saW5lS2V5Ym9hcmRCdXR0b24sIAogICAgSW5saW5lS2V5Ym9hcmRNYXJrdXAKKQpmcm9tIHB5cm9ncmFtLmVycm9ycyBpbXBvcnQgKAogICAgTWVzc2FnZUlkSW52YWxpZCwgCiAgICBNZXNzYWdlTm90TW9kaWZpZWQKKQoKCklTVCA9IHB5dHoudGltZXpvbmUoQ29uZmlnLlRJTUVfWk9ORSkKCmFkbWluX2ZpbHRlcj1maWx0ZXJzLmNyZWF0ZShpc19hZG1pbikgCgoKCkBDbGllbnQub25fbWVzc2FnZShmaWx0ZXJzLmNvbW1hbmQoWyJzY2hlZHVsZSIsIGYic2NoZWR1bGVAe0NvbmZpZy5CT1RfVVNFUk5BTUV9Il0pICYgY2hhdF9maWx0ZXIgJiBhZG1pbl9maWx0ZXIpCmFzeW5jIGRlZiBzY2hlZHVsZV92Yyhib3QsIG1lc3NhZ2UpOgogICAgd2l0aCBzdXBwcmVzcyhNZXNzYWdlSWRJbnZhbGlkLCBNZXNzYWdlTm90TW9kaWZpZWQpOgogICAgICAgIHR5cGU9IiIKICAgICAgICB5dHVybD0iIgogICAgICAgIHlzZWFyY2g9IiIKICAgICAgICBtc2cgPSBhd2FpdCBtZXNzYWdlLnJlcGx5X3RleHQoIuKaoe+4jyAqKkNoZWNraW5nIHJlY2l2ZWQgaW5wdXQuLioqIikKICAgICAgICBpZiBtZXNzYWdlLnJlcGx5X3RvX21lc3NhZ2UgYW5kIG1lc3NhZ2UucmVwbHlfdG9fbWVzc2FnZS52aWRlbzoKICAgICAgICAgICAgYXdhaXQgbXNnLmVkaXQoIuKaoe+4jyAqKkNoZWNraW5nIFRlbGVncmFtIE1lZGlhLi4uKioiKQogICAgICAgICAgICB0eXBlPSd2aWRlbycKICAgICAgICAgICAgbV92aWRlbyA9IG1lc3NhZ2UucmVwbHlfdG9fbWVzc2FnZS52aWRlbyAgICAgICAKICAgICAgICBlbGlmIG1lc3NhZ2UucmVwbHlfdG9fbWVzc2FnZSBhbmQgbWVzc2FnZS5yZXBseV90b19tZXNzYWdlLmRvY3VtZW50OgogICAgICAgICAgICBhd2FpdCBtc2cuZWRpdCgi4pqh77iPICoqQ2hlY2tpbmcgVGVsZWdyYW0gTWVkaWEuLi4qKiIpCiAgICAgICAgICAgIG1fdmlkZW8gPSBtZXNzYWdlLnJlcGx5X3RvX21lc3NhZ2UuZG9jdW1lbnQKICAgICAgICAgICAgdHlwZT0ndmlkZW8nCiAgICAgICAgICAgIGlmIG5vdCAidmlkZW8iIGluIG1fdmlkZW8ubWltZV90eXBlOgogICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IG1zZy5lZGl0KCJUaGUgZ2l2ZW4gZmlsZSBpcyBpbnZhbGlkIikKICAgICAgICBlbGlmIG1lc3NhZ2UucmVwbHlfdG9fbWVzc2FnZSBhbmQgbWVzc2FnZS5yZXBseV90b19tZXNzYWdlLmF1ZGlvOgogICAgICAgICAgICAjaWYgbm90IENvbmZpZy5JU19WSURFTzoKICAgICAgICAgICAgICAgICNyZXR1cm4gYXdhaXQgbWVzc2FnZS5yZXBseSgiUGxheSBmcm9tIGF1ZGlvIGZpbGUgaXMgYXZhaWxhYmxlIG9ubHkgaWYgVmlkZW8gTW9kZSBpZiB0dXJuZWQgb2ZmLlxuVXNlIC9zZXR0aW5ncyB0byBjb25maWd1cmUgeXB1ciBwbGF5ZXIuIikKICAgICAgICAgICAgYXdhaXQgbXNnLmVkaXQoIuKaoe+4jyAqKkNoZWNraW5nIFRlbGVncmFtIE1lZGlhLi4uKioiKQogICAgICAgICAgICB0eXBlPSdhdWRpbycKICAgICAgICAgICAgbV92aWRlbyA9IG1lc3NhZ2UucmVwbHlfdG9fbWVzc2FnZS5hdWRpbyAgICAgICAKICAgICAgICBlbHNlOgogICAgICAgICAgICBpZiBtZXNzYWdlLnJlcGx5X3RvX21lc3NhZ2UgYW5kIG1lc3NhZ2UucmVwbHlfdG9fbWVzc2FnZS50ZXh0OgogICAgICAgICAgICAgICAgcXVlcnk9bWVzc2FnZS5yZXBseV90b19tZXNzYWdlLnRleHQKICAgICAgICAgICAgZWxpZiAiICIgaW4gbWVzc2FnZS50ZXh0OgogICAgICAgICAgICAgICAgdGV4dCA9IG1lc3NhZ2UudGV4dC5zcGxpdCgiICIsIDEpCiAgICAgICAgICAgICAgICBxdWVyeSA9IHRleHRbMV0KICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGF3YWl0IG1zZy5lZGl0KCLZhNmFINiq2LnYt9mG2Yog2KPZiiDYtNmK2KEg2YTYqti02LrZitmE2Ycg2IzZgtmFINio2KfZhNix2K8g2LnZhNmJINmF2YLYt9i5INmB2YrYr9mK2Ygg2KPZiCDYsdin2KjYtyB5b3V0dWJlINmF2KjYp9i02LEuLi4uLi4uIikKICAgICAgICAgICAgICAgIGF3YWl0IGRlbGV0ZV9tZXNzYWdlcyhbbWVzc2FnZSwgbXNnXSkKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICByZWdleCA9IHIiXig/Omh0dHBzPzpcL1wvKT8oPzp3d3dcLik/eW91dHVcLj9iZSg/OlwuY29tKT9cLz8uKig/OndhdGNofGVtYmVkKT8oPzouKnY9fHZcL3xcLykoW1x3XC1fXSspXCY/IgogICAgICAgICAgICBtYXRjaCA9IHJlLm1hdGNoKHJlZ2V4LHF1ZXJ5KQogICAgICAgICAgICBpZiBtYXRjaDoKICAgICAgICAgICAgICAgIHR5cGU9InlvdXR1YmUiCiAgICAgICAgICAgICAgICB5dHVybD1xdWVyeQogICAgICAgICAgICBlbGlmIHF1ZXJ5LnN0YXJ0c3dpdGgoImh0dHAiKToKICAgICAgICAgICAgICAgIGhhc19hdWRpb18gPSBhd2FpdCBpc19hdWRpbyhxdWVyeSkKICAgICAgICAgICAgICAgIGlmIG5vdCBoYXNfYXVkaW9fOgogICAgICAgICAgICAgICAgICAgIGlmIGlzX3l0ZGxfc3VwcG9ydGVkKHF1ZXJ5KToKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT0ieXRkbF9zIgogICAgICAgICAgICAgICAgICAgICAgICB1cmw9cXVlcnkKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBtc2cuZWRpdCgiVGhpcyBpcyBhbiBpbnZhbGlkIGxpbmssIHByb3ZpZGUgbWUgYSBkaXJlY3QgbGluayBvciBhIHlvdXR1YmUgbGluay4iKQogICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBkZWxldGVfbWVzc2FnZXMoW21lc3NhZ2UsIG1zZ10pCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICAgICAgdHlwZT0iZGlyZWN0IgogICAgICAgICAgICAgICAgdXJsPXF1ZXJ5CiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICB0eXBlPSJxdWVyeSIKICAgICAgICAgICAgICAgIHlzZWFyY2g9cXVlcnkKICAgICAgICBpZiBub3QgbWVzc2FnZS5mcm9tX3VzZXIgaXMgTm9uZToKICAgICAgICAgICAgdXNlcj1mIlt7bWVzc2FnZS5mcm9tX3VzZXIuZmlyc3RfbmFtZX1dKHRnOi8vdXNlcj9pZD17bWVzc2FnZS5mcm9tX3VzZXIuaWR9KSAtIChTY2hlZHVsZWQpIgogICAgICAgICAgICB1c2VyX2lkID0gbWVzc2FnZS5mcm9tX3VzZXIuaWQKICAgICAgICBlbHNlOgogICAgICAgICAgICB1c2VyPSJBbm9ueW1vdXMgLSAoU2NoZWR1bGVkKSIKICAgICAgICAgICAgdXNlcl9pZCA9ICJhbm9ueW1vdXNfYWRtaW4iCiAgICAgICAgbm93ID0gZGF0ZXRpbWUubm93KCkKICAgICAgICBueWF2ID0gbm93LnN0cmZ0aW1lKCIlZC0lbS0lWS0lSDolTTolUyIpCiAgICAgICAgaWYgdHlwZSBpbiBbInZpZGVvIiwgImF1ZGlvIl06CiAgICAgICAgICAgIGlmIHR5cGUgPT0gImF1ZGlvIjoKICAgICAgICAgICAgICAgIGlmIG1fdmlkZW8udGl0bGUgaXMgTm9uZToKICAgICAgICAgICAgICAgICAgICBpZiBtX3ZpZGVvLmZpbGVfbmFtZSBpcyBOb25lOgogICAgICAgICAgICAgICAgICAgICAgICB0aXRsZV8gPSAiTXVzaWMiCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGVfID0gbV92aWRlby5maWxlX25hbWUKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgdGl0bGVfID0gbV92aWRlby50aXRsZQogICAgICAgICAgICAgICAgaWYgbV92aWRlby5wZXJmb3JtZXIgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICAgICAgdGl0bGUgPSBmInttX3ZpZGVvLnBlcmZvcm1lcn0gLSB7dGl0bGVffSIKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgdGl0bGU9dGl0bGVfCiAgICAgICAgICAgICAgICB1bmlxdWUgPSBmIntueWF2fV97bV92aWRlby5maWxlX3NpemV9X2F1ZGlvIgogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgdGl0bGU9bV92aWRlby5maWxlX25hbWUKICAgICAgICAgICAgICAgIHVuaXF1ZSA9IGYie255YXZ9X3ttX3ZpZGVvLmZpbGVfc2l6ZX1fdmlkZW8iCiAgICAgICAgICAgICAgICBpZiBDb25maWcuUFROOgogICAgICAgICAgICAgICAgICAgIG55ID0gcGFyc2UodGl0bGUpCiAgICAgICAgICAgICAgICAgICAgdGl0bGVfID0gbnkuZ2V0KCJ0aXRsZSIpCiAgICAgICAgICAgICAgICAgICAgaWYgdGl0bGVfOgogICAgICAgICAgICAgICAgICAgICAgICB0aXRsZSA9IHRpdGxlXwogICAgICAgICAgICBpZiB0aXRsZSBpcyBOb25lOgogICAgICAgICAgICAgICAgdGl0bGUgPSAnTXVzaWMnCiAgICAgICAgICAgIGRhdGE9eycxJzp0aXRsZSwgJzInOm1fdmlkZW8uZmlsZV9pZCwgJzMnOiJ0ZWxlZ3JhbSIsICc0Jzp1c2VyLCAnNSc6dW5pcXVlfQogICAgICAgICAgICBzaWQ9ZiJ7bWVzc2FnZS5jaGF0LmlkfV97bXNnLm1lc3NhZ2VfaWR9IgogICAgICAgICAgICBDb25maWcuU0NIRURVTEVEX1NUUkVBTVtzaWRdID0gZGF0YQogICAgICAgICAgICBhd2FpdCBzeW5jX3RvX2RiKCkKICAgICAgICBlbGlmIHR5cGUgaW4gWyJ5b3V0dWJlIiwgInF1ZXJ5IiwgInl0ZGxfcyJdOgogICAgICAgICAgICBpZiB0eXBlPT0ieW91dHViZSI6CiAgICAgICAgICAgICAgICBhd2FpdCBtc2cuZWRpdCgi4pqh77iPICoqRmV0Y2hpbmcgVmlkZW8gRnJvbSBZb3VUdWJlLi4uKioiKQogICAgICAgICAgICAgICAgdXJsPXl0dXJsCiAgICAgICAgICAgIGVsaWYgdHlwZT09InF1ZXJ5IjoKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBhd2FpdCBtc2cuZWRpdCgi4pqh77iPICoqRmV0Y2hpbmcgVmlkZW8gRnJvbSBZb3VUdWJlLi4uKioiKQogICAgICAgICAgICAgICAgICAgIHl0cXVlcnk9eXNlYXJjaAogICAgICAgICAgICAgICAgICAgIHJlc3VsdHMgPSBZb3V0dWJlU2VhcmNoKHl0cXVlcnksIG1heF9yZXN1bHRzPTEpLnRvX2RpY3QoKQogICAgICAgICAgICAgICAgICAgIHVybCA9IGYiaHR0cHM6Ly95b3V0dWJlLmNvbXtyZXN1bHRzWzBdWyd1cmxfc3VmZml4J119IgogICAgICAgICAgICAgICAgICAgIHRpdGxlID0gcmVzdWx0c1swXVsidGl0bGUiXVs6NDBdCiAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICAgICAgYXdhaXQgbXNnLmVkaXQoCiAgICAgICAgICAgICAgICAgICAgICAgICJTb25nIG5vdCBmb3VuZC5cblRyeSBpbmxpbmUgbW9kZS4uIgogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICBMT0dHRVIuZXJyb3Ioc3RyKGUpLCBleGNfaW5mbz1UcnVlKQogICAgICAgICAgICAgICAgICAgIGF3YWl0IGRlbGV0ZV9tZXNzYWdlcyhbbWVzc2FnZSwgbXNnXSkKICAgICAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgZWxpZiB0eXBlID09ICJ5dGRsX3MiOgogICAgICAgICAgICAgICAgdXJsPXVybAogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIHlkbF9vcHRzID0gewogICAgICAgICAgICAgICAgInF1aXRlIjogVHJ1ZSwKICAgICAgICAgICAgICAgICJnZW8tYnlwYXNzIjogVHJ1ZSwKICAgICAgICAgICAgICAgICJub2NoZWNrY2VydGlmaWNhdGUiOiBUcnVlCiAgICAgICAgICAgIH0KICAgICAgICAgICAgeWRsID0gWW91dHViZURMKHlkbF9vcHRzKQogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBpbmZvID0geWRsLmV4dHJhY3RfaW5mbyh1cmwsIEZhbHNlKQogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICBMT0dHRVIuZXJyb3IoZSwgZXhjX2luZm89VHJ1ZSkKICAgICAgICAgICAgICAgIGF3YWl0IG1zZy5lZGl0KAogICAgICAgICAgICAgICAgICAgIGYiWW91VHViZSBEb3dubG9hZCBFcnJvciDinYxcbkVycm9yOi0ge2V9IgogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIExPR0dFUi5lcnJvcihzdHIoZSkpCiAgICAgICAgICAgICAgICBhd2FpdCBkZWxldGVfbWVzc2FnZXMoW21lc3NhZ2UsIG1zZ10pCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgaWYgdHlwZSA9PSAieXRkbF9zIjoKICAgICAgICAgICAgICAgIHRpdGxlID0gIk11c2ljIgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIHRpdGxlPWluZm9bJ3RpdGxlJ10KICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICB0aXRsZSA9IGluZm9bInRpdGxlIl0KICAgICAgICAgICAgZGF0YT17JzEnOnRpdGxlLCAnMic6dXJsLCAnMyc6InlvdXR1YmUiLCAnNCc6dXNlciwgJzUnOmYie255YXZ9X3t1c2VyX2lkfSJ9CiAgICAgICAgICAgIHNpZD1mInttZXNzYWdlLmNoYXQuaWR9X3ttc2cubWVzc2FnZV9pZH0iCiAgICAgICAgICAgIENvbmZpZy5TQ0hFRFVMRURfU1RSRUFNW3NpZF0gPSBkYXRhCiAgICAgICAgICAgIGF3YWl0IHN5bmNfdG9fZGIoKQogICAgICAgIGVsaWYgdHlwZSA9PSAiZGlyZWN0IjoKICAgICAgICAgICAgZGF0YT17IjEiOiJNdXNpYyIsICcyJzp1cmwsICczJzoidXJsIiwgJzQnOnVzZXIsICc1JzpmIntueWF2fV97dXNlcl9pZH0ifQogICAgICAgICAgICBzaWQ9ZiJ7bWVzc2FnZS5jaGF0LmlkfV97bXNnLm1lc3NhZ2VfaWR9IgogICAgICAgICAgICBDb25maWcuU0NIRURVTEVEX1NUUkVBTVtzaWRdID0gZGF0YQogICAgICAgICAgICBhd2FpdCBzeW5jX3RvX2RiKCkKICAgICAgICBpZiBtZXNzYWdlLmNoYXQudHlwZSE9J3ByaXZhdGUnIGFuZCBtZXNzYWdlLmZyb21fdXNlciBpcyBOb25lOgogICAgICAgICAgICBhd2FpdCBtc2cuZWRpdCgKICAgICAgICAgICAgICAgIHRleHQ9IllvdSBjYW50IHNjaGVkdWxlIGZyb20gaGVyZSBzaW5jZSB5b3UgYXJlIGFuIGFub255bW91cyBhZG1pbi4gQ2xpY2sgdGhlIHNjaGVkdWxlIGJ1dHRvbiB0byBzY2hlZHVsZSB0aHJvdWdoIHByaXZhdGUgY2hhdC4iLAogICAgICAgICAgICAgICAgcmVwbHlfbWFya3VwPUlubGluZUtleWJvYXJkTWFya3VwKAogICAgICAgICAgICAgICAgICAgIFsKICAgICAgICAgICAgICAgICAgICAgICAgWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgSW5saW5lS2V5Ym9hcmRCdXR0b24oZiJTY2hlZHVsZSIsIHVybD1mImh0dHBzOi8vdGVsZWdyYW0uZG9nL3tDb25maWcuQk9UX1VTRVJOQU1FfT9zdGFydD1zY2hfe3NpZH0iKSwKICAgICAgICAgICAgICAgICAgICAgICAgXQogICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgICksKQogICAgICAgICAgICBhd2FpdCBkZWxldGVfbWVzc2FnZXMoW21lc3NhZ2UsIG1zZ10pCiAgICAgICAgICAgIHJldHVybgogICAgICAgIHRvZGF5ID0gZGF0ZXRpbWUubm93KElTVCkKICAgICAgICBzbW9udGg9dG9kYXkuc3RyZnRpbWUoIiVCIikKICAgICAgICBvYmogPSBjYWxlbmRhci5DYWxlbmRhcigpCiAgICAgICAgdGhpc2RheSA9IHRvZGF5LmRheQogICAgICAgIHllYXIgPSB0b2RheS55ZWFyCiAgICAgICAgbW9udGggPSB0b2RheS5tb250aAogICAgICAgIG09b2JqLm1vbnRoZGF5c2NhbGVuZGFyKHllYXIsIG1vbnRoKQogICAgICAgIGJ1dHRvbj1bXQogICAgICAgIGJ1dHRvbi5hcHBlbmQoW0lubGluZUtleWJvYXJkQnV0dG9uKHRleHQ9ZiJ7c3RyKHNtb250aCl9ICB7c3RyKHllYXIpfSIsY2FsbGJhY2tfZGF0YT1mInNjaF9tb250aF9jaG9vc2Vfbm9uZV9ub25lIildKQogICAgICAgIGRheXM9WyJNb24iLCAiVHVlcyIsICJXZWQiLCAiVGh1IiwgIkZyaSIsICJTYXQiLCAiU3VuIl0KICAgICAgICBmPVtdCiAgICAgICAgZm9yIGRheSBpbiBkYXlzOgogICAgICAgICAgICBmLmFwcGVuZChJbmxpbmVLZXlib2FyZEJ1dHRvbih0ZXh0PWYie2RheX0iLGNhbGxiYWNrX2RhdGE9ZiJkYXlfaW5mb19ub25lIikpCiAgICAgICAgYnV0dG9uLmFwcGVuZChmKQogICAgICAgIGZvciBvbmUgaW4gbToKICAgICAgICAgICAgZj1bXQogICAgICAgICAgICBmb3IgZCBpbiBvbmU6CiAgICAgICAgICAgICAgICB5ZWFyXz15ZWFyCiAgICAgICAgICAgICAgICBpZiBkIDwgaW50KHRvZGF5LmRheSk6CiAgICAgICAgICAgICAgICAgICAgeWVhcl8gKz0gMQogICAgICAgICAgICAgICAgaWYgZCA9PSAwOgogICAgICAgICAgICAgICAgICAgIGs9Ilx1MjA2MyIgICAKICAgICAgICAgICAgICAgICAgICBkPSJub25lIiAgIAogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBrPWQgICAgCiAgICAgICAgICAgICAgICBmLmFwcGVuZChJbmxpbmVLZXlib2FyZEJ1dHRvbih0ZXh0PWYie2t9IixjYWxsYmFja19kYXRhPWYic2NoX21vbnRoX3t5ZWFyX31fe21vbnRofV97ZH0iKSkKICAgICAgICAgICAgYnV0dG9uLmFwcGVuZChmKQogICAgICAgIGJ1dHRvbi5hcHBlbmQoW0lubGluZUtleWJvYXJkQnV0dG9uKCJDbG9zZSIsIGNhbGxiYWNrX2RhdGE9InNjaGNsb3NlIildKQogICAgICAgIGF3YWl0IG1zZy5lZGl0KGYiQ2hvb3NlIHRoZSBkYXkgb2YgdGhlIG1vbnRoIHlvdSB3YW50IHRvIHNjaGVkdWxlIHRoZSB2b2ljZWNoYXQuXG5Ub2RheSBpcyB7dGhpc2RheX0ge3Ntb250aH0ge3llYXJ9LiBDaG9vb3NpbmcgYSBkYXRlIHByZWNlZWRpbmcgdG9kYXkgd2lsbCBiZSBjb25zaWRlcmVkIGFzIG5leHQgeWVhciB7eWVhcisxfSIsIHJlcGx5X21hcmt1cD1JbmxpbmVLZXlib2FyZE1hcmt1cChidXR0b24pKQoKCgoKQENsaWVudC5vbl9tZXNzYWdlKGZpbHRlcnMuY29tbWFuZChbInNsaXN0IiwgZiJzbGlzdEB7Q29uZmlnLkJPVF9VU0VSTkFNRX0iXSkgJiBhZG1pbl9maWx0ZXIgJiBjaGF0X2ZpbHRlcikKYXN5bmMgZGVmIGxpc3Rfc2NoZWR1bGUoYm90LCBtZXNzYWdlKToKICAgIGs9YXdhaXQgbWVzc2FnZS5yZXBseSgiQ2hlY2tpbmcgc2NoZWR1bGVzLi4uIikKICAgIGlmIG5vdCBDb25maWcuU0NIRURVTEVfTElTVDoKICAgICAgICBhd2FpdCBrLmVkaXQoIk5vdGhpbmcgc2NoZWR1bGVkIHRvIHBsYXkuIikKICAgICAgICBhd2FpdCBkZWxldGVfbWVzc2FnZXMoW2ssIG1lc3NhZ2VdKQogICAgICAgIHJldHVybgogICAgdGV4dD0iQ3VycmVudCBTY2hlZHVsZXM6XG5cbiIKICAgIHM9Q29uZmlnLlNDSEVEVUxFX0xJU1QKICAgIGY9MQogICAgZm9yIHNjaCBpbiBzOgogICAgICAgIGRldGFpbHM9Q29uZmlnLlNDSEVEVUxFRF9TVFJFQU0uZ2V0KHNjaFsnam9iX2lkJ10pCiAgICAgICAgaWYgbm90IGRldGFpbHNbJzMnXT09InRlbGVncmFtIjoKICAgICAgICAgICAgdGV4dCs9ZiI8Yj57Zn0uPC9iPiBUaXRsZTogW3tkZXRhaWxzWycxJ119XSh7ZGV0YWlsc1snMiddfSkgQnkge2RldGFpbHNbJzQnXX1cbiIKICAgICAgICBlbHNlOgogICAgICAgICAgICB0ZXh0Kz1mIjxiPntmfS48L2I+IFRpdGxlOiB7ZGV0YWlsc1snMSddfSBCeSB7ZGV0YWlsc1snNCddfVxuIgogICAgICAgIGRhdGUgPSBzY2hbJ2RhdGUnXQogICAgICAgIGYrPTEKICAgICAgICBkYXRlXz0oKHB5dHoudXRjLmxvY2FsaXplKGRhdGUsIGlzX2RzdD1Ob25lKS5hc3RpbWV6b25lKElTVCkpLnJlcGxhY2UodHppbmZvPU5vbmUpKS5zdHJmdGltZSgiJWIgJWQgJVksICVJOiVNICVwIikKICAgICAgICB0ZXh0Kz1mIlNoZWR1bGUgSUQgOiA8Y29kZT57c2NoWydqb2JfaWQnXX08L2NvZGU+XG5TY2hlZHVsZSBEYXRlIDogPGNvZGU+e2RhdGVffTwvY29kZT5cblxuIgoKICAgIGF3YWl0IGsuZWRpdCh0ZXh0LCBkaXNhYmxlX3dlYl9wYWdlX3ByZXZpZXc9VHJ1ZSkKICAgIGF3YWl0IGRlbGV0ZV9tZXNzYWdlcyhbbWVzc2FnZV0pCgoKQENsaWVudC5vbl9tZXNzYWdlKGZpbHRlcnMuY29tbWFuZChbImNhbmNlbCIsIGYiY2FuY2VsQHtDb25maWcuQk9UX1VTRVJOQU1FfSJdKSAmIGFkbWluX2ZpbHRlciAmIGNoYXRfZmlsdGVyKQphc3luYyBkZWYgZGVsZXRlX3NjaChib3QsIG1lc3NhZ2UpOgogICAgd2l0aCBzdXBwcmVzcyhNZXNzYWdlSWRJbnZhbGlkLCBNZXNzYWdlTm90TW9kaWZpZWQpOgogICAgICAgIG0gPSBhd2FpdCBtZXNzYWdlLnJlcGx5KCJGaW5kaW5nIHRoZSBzY2hlZHVsZWQgc3RyZWFtLi4iKQogICAgICAgIGlmICIgIiBpbiBtZXNzYWdlLnRleHQ6CiAgICAgICAgICAgIGNtZCwgam9iX2lkID0gbWVzc2FnZS50ZXh0LnNwbGl0KCIgIiwgMSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBidXR0b25zID0gWwogICAgICAgICAgICAgICAgWwogICAgICAgICAgICAgICAgICAgIElubGluZUtleWJvYXJkQnV0dG9uKCdDYW5jZWwgQWxsIFNjaGVkdWxlcycsIGNhbGxiYWNrX2RhdGE9J3NjaGNhbmNlbCcpLAogICAgICAgICAgICAgICAgICAgIElubGluZUtleWJvYXJkQnV0dG9uKCdObycsIGNhbGxiYWNrX2RhdGE9J3NjaGNsb3NlJyksCiAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgIF0KICAgICAgICAgICAgcmVwbHlfbWFya3VwID0gSW5saW5lS2V5Ym9hcmRNYXJrdXAoYnV0dG9ucykKICAgICAgICAgICAgYXdhaXQgbS5lZGl0KCJObyBTY2hlZHVsZSBJRCAgc3BlY2lmaWVkISEgRG8geW91IHdhbnQgdG8gQ2FuY2VsIGFsbCBzY2hlZHVsZWQgc3RyZWFtcz8gb3IgeW91IGNhbiBmaW5kIHNjaGVkdWwgaWQgdXNpbmcgL3NsaXN0IGNvbW1hbmQuIiwgcmVwbHlfbWFya3VwPXJlcGx5X21hcmt1cCkKICAgICAgICAgICAgYXdhaXQgZGVsZXRlX21lc3NhZ2VzKFttZXNzYWdlXSkKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZGF0YT1Db25maWcuU0NIRURVTEVEX1NUUkVBTS5nZXQoam9iX2lkKQogICAgICAgIGlmIG5vdCBkYXRhOgogICAgICAgICAgICBhd2FpdCBtLmVkaXQoIllvdSBnYXZlIG1lIGFuIGludmFsaWQgc2NoZWR1bGUgSUQsIGNoZWNrIGFnYWluIGFuZCBzZW5kLiIpCiAgICAgICAgICAgIGF3YWl0IGRlbGV0ZV9tZXNzYWdlcyhbbWVzc2FnZSwgbV0pCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGRlbCBDb25maWcuU0NIRURVTEVEX1NUUkVBTVtqb2JfaWRdCiAgICAgICAgaz1zY2hlZHVsZXIuZ2V0X2pvYihqb2JfaWQsIGpvYnN0b3JlPU5vbmUpCiAgICAgICAgaWYgazoKICAgICAgICAgICAgc2NoZWR1bGVyLnJlbW92ZV9qb2Ioam9iX2lkLCBqb2JzdG9yZT1Ob25lKQogICAgICAgIG9sZD1saXN0KGZpbHRlcihsYW1iZGEgazoga1snam9iX2lkJ10gPT0gam9iX2lkLCBDb25maWcuU0NIRURVTEVfTElTVCkpCiAgICAgICAgaWYgb2xkOgogICAgICAgICAgICBmb3Igb2xkXyBpbiBvbGQ6CiAgICAgICAgICAgICAgICBDb25maWcuU0NIRURVTEVfTElTVC5yZW1vdmUob2xkXykKICAgICAgICBhd2FpdCBzeW5jX3RvX2RiKCkKICAgICAgICBhd2FpdCBtLmVkaXQoZiJTdWNjZXNmdWxseSBkZWxldGVkIHtkYXRhWycxJ119IGZyb20gc2NoZWR1bGVkIGxpc3QuIikKICAgICAgICBhd2FpdCBkZWxldGVfbWVzc2FnZXMoW21lc3NhZ2UsIG1dKQogICAgICAgIApAQ2xpZW50Lm9uX21lc3NhZ2UoZmlsdGVycy5jb21tYW5kKFsiY2FuY2VsYWxsIiwgZiJjYW5jZWxhbGxAe0NvbmZpZy5CT1RfVVNFUk5BTUV9Il0pICYgYWRtaW5fZmlsdGVyICYgY2hhdF9maWx0ZXIpCmFzeW5jIGRlZiBkZWxldGVfYWxsX3NjaChib3QsIG1lc3NhZ2UpOgogICAgYnV0dG9ucyA9IFsKICAgICAgICBbCiAgICAgICAgICAgIElubGluZUtleWJvYXJkQnV0dG9uKCdDYW5jZWwgQWxsIFNjaGVkdWxlcycsIGNhbGxiYWNrX2RhdGE9J3NjaGNhbmNlbCcpLAogICAgICAgICAgICBJbmxpbmVLZXlib2FyZEJ1dHRvbignTm8nLCBjYWxsYmFja19kYXRhPSdzY2hjbG9zZScpLAogICAgICAgIF0KICAgIF0KICAgIHJlcGx5X21hcmt1cCA9IElubGluZUtleWJvYXJkTWFya3VwKGJ1dHRvbnMpCiAgICBhd2FpdCBtZXNzYWdlLnJlcGx5KCJEbyB5b3Ugd2FudCB0byBjYW5jZWwgYWxsIHRoZSBzY2hlZHVsZWQgc3RyZWFtcz/jhaTjhaTjhaTjhaQg44WkIiwgcmVwbHlfbWFya3VwPXJlcGx5X21hcmt1cCkKICAgIGF3YWl0IGRlbGV0ZV9tZXNzYWdlcyhbbWVzc2FnZV0pCgoK'))