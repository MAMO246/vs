#TeleGram: @ADIL721
import base64
exec(base64.b64decode('IyEvdXNyL2Jpbi9lbnYgcHl0aG9uMwojIENvcHlyaWdodCAoQykgQHN1YmlucHMKIyBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTogeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQojIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEFmZmVybyBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQojIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIGVpdGhlciB2ZXJzaW9uIDMgb2YgdGhlIExpY2Vuc2UsIG9yCiMgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4KCiMgVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCiMgYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKIyBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlCiMgR05VIEFmZmVybyBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCgojIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBBZmZlcm8gR2VuZXJhbCBQdWJsaWMgTGljZW5zZQojIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtLiAgSWYgbm90LCBzZWUgPGh0dHBzOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4KZnJvbSB1dGlscyBpbXBvcnQgTE9HR0VSCmZyb20gY29udGV4dGxpYiBpbXBvcnQgc3VwcHJlc3MKZnJvbSBjb25maWcgaW1wb3J0IENvbmZpZwppbXBvcnQgY2FsZW5kYXIKaW1wb3J0IHB5dHoKZnJvbSBkYXRldGltZSBpbXBvcnQgZGF0ZXRpbWUKaW1wb3J0IGFzeW5jaW8KaW1wb3J0IG9zCmZyb20gcHlyb2dyYW0uZXJyb3JzLmV4Y2VwdGlvbnMuYmFkX3JlcXVlc3RfNDAwIGltcG9ydCAoCiAgICBNZXNzYWdlSWRJbnZhbGlkLCAKICAgIE1lc3NhZ2VOb3RNb2RpZmllZAopCmZyb20gcHlyb2dyYW0udHlwZXMgaW1wb3J0ICgKICAgIElubGluZUtleWJvYXJkTWFya3VwLCAKICAgIElubGluZUtleWJvYXJkQnV0dG9uCikKZnJvbSB1dGlscyBpbXBvcnQgKAogICAgY2FuY2VsX2FsbF9zY2hlZHVsZXMsCiAgICBlZGl0X2NvbmZpZywgCiAgICBpc19hZG1pbiwgCiAgICBsZWF2ZV9jYWxsLCAKICAgIHJlc3RhcnQsCiAgICByZXN0YXJ0X3BsYXlvdXQsCiAgICBzdG9wX3JlY29yZGluZywgCiAgICBzeW5jX3RvX2RiLAogICAgdXBkYXRlLCAKICAgIGlzX2FkbWluLCAKICAgIGNoYXRfZmlsdGVyLAogICAgc3Vkb19maWx0ZXIsCiAgICBkZWxldGVfbWVzc2FnZXMsCiAgICBzZWVrX2ZpbGUKKQpmcm9tIHB5cm9ncmFtIGltcG9ydCAoCiAgICBDbGllbnQsIAogICAgZmlsdGVycwopCgpJU1QgPSBweXR6LnRpbWV6b25lKENvbmZpZy5USU1FX1pPTkUpCmlmIENvbmZpZy5EQVRBQkFTRV9VUkk6CiAgICBmcm9tIHV0aWxzIGltcG9ydCBkYgoKSE9NRV9URVhUID0gIjxiPtmF2LHYrdio2KfZiyBbe31dKHRnOi8vdXNlcj9pZD17fSkg8J+YtFxuXG7Yp9mG2Kcg2KjZiNiqINmE2KrYtNi62YrZhCDYp9mE2YLYsdin2YYg2YHZiiDYp9mE2YLZhtmI2KfYqiDYp9mIINin2YTZgtix2YjYqNin2Kog2KfYtti62Lcg2LnZhNmKINiy2LEg2YXYs9in2LnYr9ipINmB2Yog2KfZhNin2LPZgdmEINmE2LHYpNmK2Kkg2KfZhNin2YjYp9mF2LEuPC9iPiIKYWRtaW5fZmlsdGVyPWZpbHRlcnMuY3JlYXRlKGlzX2FkbWluKSAKCkBDbGllbnQub25fbWVzc2FnZShmaWx0ZXJzLmNvbW1hbmQoWydzdGFydCcsIGYic3RhcnRAe0NvbmZpZy5CT1RfVVNFUk5BTUV9Il0pKQphc3luYyBkZWYgc3RhcnQoY2xpZW50LCBtZXNzYWdlKToKICAgIGlmIGxlbihtZXNzYWdlLmNvbW1hbmQpID4gMToKICAgICAgICBpZiBtZXNzYWdlLmNvbW1hbmRbMV0gPT0gJ2hlbHAnOgogICAgICAgICAgICByZXBseV9tYXJrdXA9SW5saW5lS2V5Ym9hcmRNYXJrdXAoCiAgICAgICAgICAgICAgICBbCiAgICAgICAgICAgICAgICAgICAgWwogICAgICAgICAgICAgICAgICAgICAgICBJbmxpbmVLZXlib2FyZEJ1dHRvbihmItin2YjYp9mF2LEg2KfZhNiq2LTYutmK2YTwn462IiwgY2FsbGJhY2tfZGF0YT0naGVscF9wbGF5JyksCiAgICAgICAgICAgICAgICAgICAgICAgIElubGluZUtleWJvYXJkQnV0dG9uKGYi2KfZhNin2LnYr9in2K/Yp9iq4pqZ77iPIiwgY2FsbGJhY2tfZGF0YT1mImhlbHBfc2V0dGluZ3MiKSwKICAgICAgICAgICAgICAgICAgICAgICAgSW5saW5lS2V5Ym9hcmRCdXR0b24oZiLYp9mI2KfZhdixINin2YTYqtiz2KzZitmE8J+OpiIsIGNhbGxiYWNrX2RhdGE9J2hlbHBfcmVjb3JkJyksCiAgICAgICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgICAgICBbCiAgICAgICAgICAgICAgICAgICAgICAgIElubGluZUtleWJvYXJkQnV0dG9uKCLYp9mI2KfZhdixINin2YTYrNiv2YjZhNip8J+OriIsIGNhbGxiYWNrX2RhdGE9ImhlbHBfc2NoZWR1bGUiKSwKICAgICAgICAgICAgICAgICAgICAgICAgSW5saW5lS2V5Ym9hcmRCdXR0b24oItin2YjYp9mF2LEg2KfZhNiq2K3Zg9mFIiwgY2FsbGJhY2tfZGF0YT0naGVscF9jb250cm9sJyksCiAgICAgICAgICAgICAgICAgICAgICAgIElubGluZUtleWJvYXJkQnV0dG9uKCLYp9mI2KfZhdixINin2YTYp9iv2YXZhtmK2Knwn5GuIiwgY2FsbGJhY2tfZGF0YT0iaGVscF9hZG1pbiIpLAogICAgICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICAgICAgWwogICAgICAgICAgICAgICAgICAgICAgICBJbmxpbmVLZXlib2FyZEJ1dHRvbihmItin2YjYp9mF2LEg2KfZhNij2K7Yt9in2KEgIiwgY2FsbGJhY2tfZGF0YT0naGVscF9taXNjJyksCiAgICAgICAgICAgICAgICAgICAgICAgIElubGluZUtleWJvYXJkQnV0dG9uKCLYpdi62YTYp9mC8J+Xke+4jyIsIGNhbGxiYWNrX2RhdGE9ImNsb3NlIiksCiAgICAgICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgYXdhaXQgbWVzc2FnZS5yZXBseSgi2YTYsdik2YrYqSDYp9mI2KfZhdixINin2YTYqNmI2KosINin2LbYuti3INi52YTZiiwg2YXYs9in2LnYr9ipINmF2YYg2KfZhNin2LLYsdin2LEg2YHZiiDYp9mE2KfYs9mB2YQuIiwKICAgICAgICAgICAgICAgIHJlcGx5X21hcmt1cD1yZXBseV9tYXJrdXAsCiAgICAgICAgICAgICAgICBkaXNhYmxlX3dlYl9wYWdlX3ByZXZpZXc9VHJ1ZQogICAgICAgICAgICAgICAgKQogICAgICAgIGVsaWYgJ3NjaCcgaW4gbWVzc2FnZS5jb21tYW5kWzFdOgogICAgICAgICAgICBtc2c9YXdhaXQgbWVzc2FnZS5yZXBseSgiQ2hlY2tpbmcgc2NoZWR1bGVzLi4iKQogICAgICAgICAgICB5b3UsIG1lID0gbWVzc2FnZS5jb21tYW5kWzFdLnNwbGl0KCJfIiwgMSkKICAgICAgICAgICAgd2hvPUNvbmZpZy5TQ0hFRFVMRURfU1RSRUFNLmdldChtZSkKICAgICAgICAgICAgaWYgbm90IHdobzoKICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCBtc2cuZWRpdCgiU29tZXRoaW5nIGdvbmUgc29tZXdoZXJlLiIpCiAgICAgICAgICAgIGRlbCBDb25maWcuU0NIRURVTEVEX1NUUkVBTVttZV0KICAgICAgICAgICAgd2hvbT1mInttZXNzYWdlLmNoYXQuaWR9X3ttc2cubWVzc2FnZV9pZH0iCiAgICAgICAgICAgIENvbmZpZy5TQ0hFRFVMRURfU1RSRUFNW3dob21dID0gd2hvCiAgICAgICAgICAgIGF3YWl0IHN5bmNfdG9fZGIoKQogICAgICAgICAgICBpZiBtZXNzYWdlLmZyb21fdXNlci5pZCBub3QgaW4gQ29uZmlnLkFETUlOUzoKICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCBtc2cuZWRpdCgiT0sgZGEiKQogICAgICAgICAgICB0b2RheSA9IGRhdGV0aW1lLm5vdyhJU1QpCiAgICAgICAgICAgIHNtb250aD10b2RheS5zdHJmdGltZSgiJUIiKQogICAgICAgICAgICBvYmogPSBjYWxlbmRhci5DYWxlbmRhcigpCiAgICAgICAgICAgIHRoaXNkYXkgPSB0b2RheS5kYXkKICAgICAgICAgICAgeWVhciA9IHRvZGF5LnllYXIKICAgICAgICAgICAgbW9udGggPSB0b2RheS5tb250aAogICAgICAgICAgICBtPW9iai5tb250aGRheXNjYWxlbmRhcih5ZWFyLCBtb250aCkKICAgICAgICAgICAgYnV0dG9uPVtdCiAgICAgICAgICAgIGJ1dHRvbi5hcHBlbmQoW0lubGluZUtleWJvYXJkQnV0dG9uKHRleHQ9ZiJ7c3RyKHNtb250aCl9ICB7c3RyKHllYXIpfSIsY2FsbGJhY2tfZGF0YT1mInNjaF9tb250aF9jaG9vc2Vfbm9uZV9ub25lIildKQogICAgICAgICAgICBkYXlzPVsiTW9uIiwgIlR1ZXMiLCAiV2VkIiwgIlRodSIsICJGcmkiLCAiU2F0IiwgIlN1biJdCiAgICAgICAgICAgIGY9W10KICAgICAgICAgICAgZm9yIGRheSBpbiBkYXlzOgogICAgICAgICAgICAgICAgZi5hcHBlbmQoSW5saW5lS2V5Ym9hcmRCdXR0b24odGV4dD1mIntkYXl9IixjYWxsYmFja19kYXRhPWYiZGF5X2luZm9fbm9uZSIpKQogICAgICAgICAgICBidXR0b24uYXBwZW5kKGYpCiAgICAgICAgICAgIGZvciBvbmUgaW4gbToKICAgICAgICAgICAgICAgIGY9W10KICAgICAgICAgICAgICAgIGZvciBkIGluIG9uZToKICAgICAgICAgICAgICAgICAgICB5ZWFyXz15ZWFyCiAgICAgICAgICAgICAgICAgICAgaWYgZCA8IGludCh0b2RheS5kYXkpOgogICAgICAgICAgICAgICAgICAgICAgICB5ZWFyXyArPSAxCiAgICAgICAgICAgICAgICAgICAgaWYgZCA9PSAwOgogICAgICAgICAgICAgICAgICAgICAgICBrPSJcdTIwNjMiICAgCiAgICAgICAgICAgICAgICAgICAgICAgIGQ9Im5vbmUiICAgCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgaz1kICAgIAogICAgICAgICAgICAgICAgICAgIGYuYXBwZW5kKElubGluZUtleWJvYXJkQnV0dG9uKHRleHQ9ZiJ7a30iLGNhbGxiYWNrX2RhdGE9ZiJzY2hfbW9udGhfe3llYXJffV97bW9udGh9X3tkfSIpKQogICAgICAgICAgICAgICAgYnV0dG9uLmFwcGVuZChmKQogICAgICAgICAgICBidXR0b24uYXBwZW5kKFtJbmxpbmVLZXlib2FyZEJ1dHRvbigiQ2xvc2UiLCBjYWxsYmFja19kYXRhPSJzY2hjbG9zZSIpXSkKICAgICAgICAgICAgYXdhaXQgbXNnLmVkaXQoZiJDaG9vc2UgdGhlIGRheSBvZiB0aGUgbW9udGggeW91IHdhbnQgdG8gc2NoZWR1bGUgdGhlIHZvaWNlY2hhdC5cblRvZGF5IGlzIHt0aGlzZGF5fSB7c21vbnRofSB7eWVhcn0uIENob29vc2luZyBhIGRhdGUgcHJlY2VlZGluZyB0b2RheSB3aWxsIGJlIGNvbnNpZGVyZWQgYXMgbmV4dCB5ZWFyIHt5ZWFyKzF9IiwgcmVwbHlfbWFya3VwPUlubGluZUtleWJvYXJkTWFya3VwKGJ1dHRvbikpCgoKCiAgICAgICAgcmV0dXJuCiAgICBidXR0b25zID0gWwogICAgICAgIFsKICAgICAgICAgICAgSW5saW5lS2V5Ym9hcmRCdXR0b24oJ+Kame+4jyDZgtmG2KfYqSDYp9mE2KrYrdiv2YrYq9in2KonLCB1cmw9J2h0dHBzOi8vdC5tZS9NQU1PMjQ2JyksCiAgICAgICAgICAgIElubGluZUtleWJvYXJkQnV0dG9uKCfwn6epINmC2YbYp9ipINin2YTYs9mI2LHYsycsIHVybD0naHR0cHM6Ly90Lm1lL2lQdXJleCcpCiAgICAgICAgXSwKICAgICAgICBbCiAgICAgICAgICAgIElubGluZUtleWJvYXJkQnV0dG9uKCfwn5Go8J+PvOKAjfCfpq8g2YXYs9in2LnYr9ipJywgY2FsbGJhY2tfZGF0YT0naGVscF9tYWluJyksCiAgICAgICAgICAgIElubGluZUtleWJvYXJkQnV0dG9uKCfwn5eRINil2LrZhNin2YInLCBjYWxsYmFja19kYXRhPSdjbG9zZScpLAogICAgICAgIF0KICAgIF0KICAgIHJlcGx5X21hcmt1cCA9IElubGluZUtleWJvYXJkTWFya3VwKGJ1dHRvbnMpCiAgICBrID0gYXdhaXQgbWVzc2FnZS5yZXBseShIT01FX1RFWFQuZm9ybWF0KG1lc3NhZ2UuZnJvbV91c2VyLmZpcnN0X25hbWUsIG1lc3NhZ2UuZnJvbV91c2VyLmlkKSwgcmVwbHlfbWFya3VwPXJlcGx5X21hcmt1cCkKICAgIGF3YWl0IGRlbGV0ZV9tZXNzYWdlcyhbbWVzc2FnZSwga10pCgoKCkBDbGllbnQub25fbWVzc2FnZShmaWx0ZXJzLmNvbW1hbmQoWyJoZWxwIiwgZiJoZWxwQHtDb25maWcuQk9UX1VTRVJOQU1FfSJdKSkKYXN5bmMgZGVmIHNob3dfaGVscChjbGllbnQsIG1lc3NhZ2UpOgogICAgcmVwbHlfbWFya3VwPUlubGluZUtleWJvYXJkTWFya3VwKAogICAgICAgIFsKICAgICAgICAgICAgWwogICAgICAgICAgICAgICAgSW5saW5lS2V5Ym9hcmRCdXR0b24oIlBsYXkiLCBjYWxsYmFja19kYXRhPSdoZWxwX3BsYXknKSwKICAgICAgICAgICAgICAgIElubGluZUtleWJvYXJkQnV0dG9uKCJTZXR0aW5ncyIsIGNhbGxiYWNrX2RhdGE9ZiJoZWxwX3NldHRpbmdzIiksCiAgICAgICAgICAgICAgICBJbmxpbmVLZXlib2FyZEJ1dHRvbigiUmVjb3JkaW5nIiwgY2FsbGJhY2tfZGF0YT0naGVscF9yZWNvcmQnKSwKICAgICAgICAgICAgXSwKICAgICAgICAgICAgWwogICAgICAgICAgICAgICAgSW5saW5lS2V5Ym9hcmRCdXR0b24oIlNjaGVkdWxpbmciLCBjYWxsYmFja19kYXRhPSJoZWxwX3NjaGVkdWxlIiksCiAgICAgICAgICAgICAgICBJbmxpbmVLZXlib2FyZEJ1dHRvbigiQ29udHJvbGluZyIsIGNhbGxiYWNrX2RhdGE9J2hlbHBfY29udHJvbCcpLAogICAgICAgICAgICAgICAgSW5saW5lS2V5Ym9hcmRCdXR0b24oIkFkbWlucyIsIGNhbGxiYWNrX2RhdGE9ImhlbHBfYWRtaW4iKSwKICAgICAgICAgICAgXSwKICAgICAgICAgICAgWwogICAgICAgICAgICAgICAgSW5saW5lS2V5Ym9hcmRCdXR0b24oIk1pc2MiLCBjYWxsYmFja19kYXRhPSdoZWxwX21pc2MnKSwKICAgICAgICAgICAgICAgIElubGluZUtleWJvYXJkQnV0dG9uKCJDb25maWcgVmFycyIsIGNhbGxiYWNrX2RhdGE9J2hlbHBfZW52JyksCiAgICAgICAgICAgICAgICBJbmxpbmVLZXlib2FyZEJ1dHRvbigiQ2xvc2UiLCBjYWxsYmFja19kYXRhPSJjbG9zZSIpLAogICAgICAgICAgICBdLAogICAgICAgIF0KICAgICAgICApCiAgICBpZiBtZXNzYWdlLmNoYXQudHlwZSAhPSAicHJpdmF0ZSIgYW5kIG1lc3NhZ2UuZnJvbV91c2VyIGlzIE5vbmU6CiAgICAgICAgaz1hd2FpdCBtZXNzYWdlLnJlcGx5KAogICAgICAgICAgICB0ZXh0PSJJIGNhbnQgaGVscCB5b3UgaGVyZSwgc2luY2UgeW91IGFyZSBhbiBhbm9ueW1vdXMgYWRtaW4uIEdldCBoZWxwIGluIFBNIiwKICAgICAgICAgICAgcmVwbHlfbWFya3VwPUlubGluZUtleWJvYXJkTWFya3VwKAogICAgICAgICAgICAgICAgWwogICAgICAgICAgICAgICAgICAgIFsKICAgICAgICAgICAgICAgICAgICAgICAgSW5saW5lS2V5Ym9hcmRCdXR0b24oZiJIZWxwIiwgdXJsPWYiaHR0cHM6Ly90ZWxlZ3JhbS5kb2cve0NvbmZpZy5CT1RfVVNFUk5BTUV9P3N0YXJ0PWhlbHAiKSwKICAgICAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICksKQogICAgICAgIGF3YWl0IGRlbGV0ZV9tZXNzYWdlcyhbbWVzc2FnZSwga10pCiAgICAgICAgcmV0dXJuCiAgICBpZiBDb25maWcubXNnLmdldCgnaGVscCcpIGlzIG5vdCBOb25lOgogICAgICAgIGF3YWl0IENvbmZpZy5tc2dbJ2hlbHAnXS5kZWxldGUoKQogICAgQ29uZmlnLm1zZ1snaGVscCddID0gYXdhaXQgbWVzc2FnZS5yZXBseV90ZXh0KAogICAgICAgICJMZWFybiB0byB1c2UgdGhlIFZDUGxheWVyLCBTaG93aW5nIGhlbHAgbWVudSwgQ2hvb3NlIGZyb20gdGhlIGJlbG93IG9wdGlvbnMuIiwKICAgICAgICByZXBseV9tYXJrdXA9cmVwbHlfbWFya3VwLAogICAgICAgIGRpc2FibGVfd2ViX3BhZ2VfcHJldmlldz1UcnVlCiAgICAgICAgKQogICAgI2F3YWl0IGRlbGV0ZV9tZXNzYWdlcyhbbWVzc2FnZV0pCkBDbGllbnQub25fbWVzc2FnZShmaWx0ZXJzLmNvbW1hbmQoWydyZXBvJywgZiJyZXBvQHtDb25maWcuQk9UX1VTRVJOQU1FfSJdKSkKYXN5bmMgZGVmIHJlcG9fKGNsaWVudCwgbWVzc2FnZSk6CiAgICBidXR0b25zID0gWwogICAgICAgIFsKICAgICAgICAgICAgSW5saW5lS2V5Ym9hcmRCdXR0b24oJ/Cfp6kg2YLZhtin2Kkg2KfZhNiz2YjYsdizJywgdXJsPSdodHRwczovL3QubWUvTUFNTzI0NicpLAogICAgICAgICAgICBJbmxpbmVLZXlib2FyZEJ1dHRvbign4pqZ77iPINmC2YbYp9ipINin2YTYqtit2K/Zitir2KfYqicsIHVybD0naHR0cHM6Ly90Lm1lL2lQdXJleCcpLCAgICAgCiAgICAgICAgXSwKICAgICAgICBbCiAgICAgICAgICAgIElubGluZUtleWJvYXJkQnV0dG9uKCLwn46eINmC2YbYp9ipINin2YTYs9mI2LHYsyIsIHVybD0naHR0cHM6Ly90Lm1lL01BTU8yNDYnKSwKICAgICAgICAgICAgSW5saW5lS2V5Ym9hcmRCdXR0b24oJ/Cfl5Eg2KXYutmE2KfZgicsIGNhbGxiYWNrX2RhdGE9J2Nsb3NlJyksCiAgICAgICAgXQogICAgXQogICAgYXdhaXQgbWVzc2FnZS5yZXBseSgiPGI+VGhlIHNvdXJjZSBjb2RlIG9mIHRoaXMgYm90IGlzIHB1YmxpYyBhbmQgY2FuIGJlIGZvdW5kIGF0IDxhIGhyZWY9aHR0cHM6Ly9naXRodWIuY29tL01BTU8yNDYvdnM+VkNQbGF5ZXJCb3QuPC9hPlxuWW91IGNhbiBkZXBsb3kgeW91ciBvd24gYm90IGFuZCB1c2UgaW4geW91ciBncm91cC5cblxuRmVlbCBmcmVlIHRvIHN0YXLimIDvuI8gdGhlIHJlcG8gaWYgeW91IGxpa2VkIGl0IPCfmYMuPC9iPiIsIHJlcGx5X21hcmt1cD1JbmxpbmVLZXlib2FyZE1hcmt1cChidXR0b25zKSwgZGlzYWJsZV93ZWJfcGFnZV9wcmV2aWV3PVRydWUpCiAgICBhd2FpdCBkZWxldGVfbWVzc2FnZXMoW21lc3NhZ2VdKQoKQENsaWVudC5vbl9tZXNzYWdlKGZpbHRlcnMuY29tbWFuZChbJ3Jlc3RhcnQnLCAndXBkYXRlJywgZiJyZXN0YXJ0QHtDb25maWcuQk9UX1VTRVJOQU1FfSIsIGYidXBkYXRlQHtDb25maWcuQk9UX1VTRVJOQU1FfSJdKSAmIGFkbWluX2ZpbHRlciAmIGNoYXRfZmlsdGVyKQphc3luYyBkZWYgdXBkYXRlX2hhbmRsZXIoY2xpZW50LCBtZXNzYWdlKToKICAgIGlmIENvbmZpZy5IRVJPS1VfQVBQOgogICAgICAgIGsgPSBhd2FpdCBtZXNzYWdlLnJlcGx5KCJIZXJva3UgQVBQIGZvdW5kLCBSZXN0YXJ0aW5nIGFwcCB0byB1cGRhdGUuIikKICAgICAgICBpZiBDb25maWcuREFUQUJBU0VfVVJJOgogICAgICAgICAgICBtc2cgPSB7Im1zZ19pZCI6ay5tZXNzYWdlX2lkLCAiY2hhdF9pZCI6ay5jaGF0LmlkfQogICAgICAgICAgICBpZiBub3QgYXdhaXQgZGIuaXNfc2F2ZWQoIlJFU1RBUlQiKToKICAgICAgICAgICAgICAgIGRiLmFkZF9jb25maWcoIlJFU1RBUlQiLCBtc2cpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBhd2FpdCBkYi5lZGl0X2NvbmZpZygiUkVTVEFSVCIsIG1zZykKICAgICAgICAgICAgYXdhaXQgc3luY190b19kYigpCiAgICBlbHNlOgogICAgICAgIGsgPSBhd2FpdCBtZXNzYWdlLnJlcGx5KCLjgL3vuI/YrNin2LHZjSDZhdit2KfZiNmE2KnYjCDYp9i52KfYr9ipINiq2LTYutmK2YQg2KfZhNio2YjYqi4uLi4uIikKICAgICAgICBpZiBDb25maWcuREFUQUJBU0VfVVJJOgogICAgICAgICAgICBtc2cgPSB7Im1zZ19pZCI6ay5tZXNzYWdlX2lkLCAiY2hhdF9pZCI6ay5jaGF0LmlkfQogICAgICAgICAgICBpZiBub3QgYXdhaXQgZGIuaXNfc2F2ZWQoIlJFU1RBUlQiKToKICAgICAgICAgICAgICAgIGRiLmFkZF9jb25maWcoIlJFU1RBUlQiLCBtc2cpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBhd2FpdCBkYi5lZGl0X2NvbmZpZygiUkVTVEFSVCIsIG1zZykKICAgIHRyeToKICAgICAgICBhd2FpdCBtZXNzYWdlLmRlbGV0ZSgpCiAgICBleGNlcHQ6CiAgICAgICAgcGFzcwogICAgYXdhaXQgdXBkYXRlKCkKCkBDbGllbnQub25fbWVzc2FnZShmaWx0ZXJzLmNvbW1hbmQoWydsb2dzJywgZiJsb2dzQHtDb25maWcuQk9UX1VTRVJOQU1FfSJdKSAmIGFkbWluX2ZpbHRlciAmIGNoYXRfZmlsdGVyKQphc3luYyBkZWYgZ2V0X2xvZ3MoY2xpZW50LCBtZXNzYWdlKToKICAgIG09YXdhaXQgbWVzc2FnZS5yZXBseSgiQ2hlY2tpbmcgbG9ncy4uIikKICAgIGlmIG9zLnBhdGguZXhpc3RzKCJib3Rsb2cudHh0Iik6CiAgICAgICAgYXdhaXQgbWVzc2FnZS5yZXBseV9kb2N1bWVudCgnYm90bG9nLnR4dCcsIGNhcHRpb249IkJvdCBMb2dzIikKICAgICAgICBhd2FpdCBtLmRlbGV0ZSgpCiAgICAgICAgYXdhaXQgZGVsZXRlX21lc3NhZ2VzKFttZXNzYWdlXSkKICAgIGVsc2U6CiAgICAgICAgayA9IGF3YWl0IG0uZWRpdCgiTm8gbG9nIGZpbGVzIGZvdW5kLiIpCiAgICAgICAgYXdhaXQgZGVsZXRlX21lc3NhZ2VzKFttZXNzYWdlLCBrXSkKCkBDbGllbnQub25fbWVzc2FnZShmaWx0ZXJzLmNvbW1hbmQoWydlbnYnLCBmImVudkB7Q29uZmlnLkJPVF9VU0VSTkFNRX0iLCAiY29uZmlnIiwgZiJjb25maWdAe0NvbmZpZy5CT1RfVVNFUk5BTUV9Il0pICYgc3Vkb19maWx0ZXIgJiBjaGF0X2ZpbHRlcikKYXN5bmMgZGVmIHNldF9oZXJva3VfdmFyKGNsaWVudCwgbWVzc2FnZSk6CiAgICB3aXRoIHN1cHByZXNzKE1lc3NhZ2VJZEludmFsaWQsIE1lc3NhZ2VOb3RNb2RpZmllZCk6CiAgICAgICAgbSA9IGF3YWl0IG1lc3NhZ2UucmVwbHkoIkNoZWNraW5nIGNvbmZpZyB2YXJzLi4iKQogICAgICAgIGlmICIgIiBpbiBtZXNzYWdlLnRleHQ6CiAgICAgICAgICAgIGNtZCwgZW52ID0gbWVzc2FnZS50ZXh0LnNwbGl0KCIgIiwgMSkKICAgICAgICAgICAgaWYgIj0iIGluIGVudjoKICAgICAgICAgICAgICAgIHZhciwgdmFsdWUgPSBlbnYuc3BsaXQoIj0iLCAxKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaWYgZW52ID09ICJTVEFSVFVQX1NUUkVBTSI6CiAgICAgICAgICAgICAgICAgICAgZW52XyA9ICJTVFJFQU1fVVJMIgogICAgICAgICAgICAgICAgZWxpZiBlbnYgPT0gIlFVQUxJVFkiOgogICAgICAgICAgICAgICAgICAgIGVudl8gPSAiQ1VTVE9NX1FVQUxJVFkiIAogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBlbnZfID0gZW52CiAgICAgICAgICAgICAgICBFTlZfVkFSUyA9IFsiQURNSU5TIiwgIlNVRE8iLCAiQ0hBVCIsICJMT0dfR1JPVVAiLCAiU1RSRUFNX1VSTCIsICJTSFVGRkxFIiwgIkFETUlOX09OTFkiLCAiUkVQTFlfTUVTU0FHRSIsIAogICAgICAgICAgICAgICAgICAgICAgICAiRURJVF9USVRMRSIsICJSRUNPUkRJTkdfRFVNUCIsICJSRUNPUkRJTkdfVElUTEUiLCAiSVNfVklERU8iLCAiSVNfTE9PUCIsICJERUxBWSIsICJQT1JUUkFJVCIsIAogICAgICAgICAgICAgICAgICAgICAgICAiSVNfVklERU9fUkVDT1JEIiwgIlBUTiIsICJDVVNUT01fUVVBTElUWSJdCiAgICAgICAgICAgICAgICBpZiBlbnZfIGluIEVOVl9WQVJTOgogICAgICAgICAgICAgICAgICAgIGF3YWl0IG0uZWRpdChmIkN1cnJlbnQgVmFsdWUgZm9yIGB7ZW52fWAgIGlzIGB7Z2V0YXR0cihDb25maWcsIGVudl8pfWAiKQogICAgICAgICAgICAgICAgICAgIGF3YWl0IGRlbGV0ZV9tZXNzYWdlcyhbbWVzc2FnZV0pCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIGF3YWl0IG0uZWRpdCgiVGhpcyBpcyBhbiBpbnZhbGlkIGVudiB2YWx1ZS4gUmVhZCBoZWxwIG9uIGVudiB0byBrbm93IGFib3V0IGF2YWlsYWJsZSBlbnYgdmFycy4iKQogICAgICAgICAgICAgICAgICAgIGF3YWl0IGRlbGV0ZV9tZXNzYWdlcyhbbWVzc2FnZSwgbV0pCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICAgICAKICAgICAgICAgICAgCiAgICAgICAgZWxzZToKICAgICAgICAgICAgYXdhaXQgbS5lZGl0KCJZb3UgaGF2ZW4ndCBwcm92aWRlZCBhbnkgdmFsdWUgZm9yIGVudiwgeW91IHNob3VsZCBmb2xsb3cgdGhlIGNvcnJlY3QgZm9ybWF0LlxuRXhhbXBsZTogPGNvZGU+L2VudiBDSEFUPS0xMDIwMjAyMDIwMjAyPC9jb2RlPiB0byBjaGFuZ2Ugb3Igc2V0IENIQVQgdmFyLlxuPGNvZGU+L2VudiBSRVBMWV9NRVNTQUdFPSA8Y29kZT5UbyBkZWxldGUgUkVQTFlfTUVTU0FHRS4iKQogICAgICAgICAgICBhd2FpdCBkZWxldGVfbWVzc2FnZXMoW21lc3NhZ2UsIG1dKQogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgaWYgQ29uZmlnLkRBVEFCQVNFX1VSSSBhbmQgdmFyIGluIFsiU1RBUlRVUF9TVFJFQU0iLCAiQ0hBVCIsICJMT0dfR1JPVVAiLCAiUkVQTFlfTUVTU0FHRSIsICJERUxBWSIsICJSRUNPUkRJTkdfRFVNUCIsICJRVUFMSVRZIl06ICAgICAgCiAgICAgICAgICAgIGF3YWl0IG0uZWRpdCgiTW9uZ28gREIgRm91bmQsIFNldHRpbmcgdXAgY29uZmlnIHZhcnMuLi4iKQogICAgICAgICAgICBhd2FpdCBhc3luY2lvLnNsZWVwKDIpICAKICAgICAgICAgICAgaWYgbm90IHZhbHVlOgogICAgICAgICAgICAgICAgYXdhaXQgbS5lZGl0KGYiTm8gdmFsdWUgZm9yIGVudiBzcGVjaWZpZWQuIFRyeWluZyB0byBkZWxldGUgZW52IHt2YXJ9LiIpCiAgICAgICAgICAgICAgICBhd2FpdCBhc3luY2lvLnNsZWVwKDIpCiAgICAgICAgICAgICAgICBpZiB2YXIgaW4gWyJTVEFSVFVQX1NUUkVBTSIsICJDSEFUIiwgIkRFTEFZIl06CiAgICAgICAgICAgICAgICAgICAgYXdhaXQgbS5lZGl0KCJUaGlzIGlzIGEgbWFuZGF0b3J5IHZhciBhbmQgY2Fubm90IGJlIGRlbGV0ZWQuIikKICAgICAgICAgICAgICAgICAgICBhd2FpdCBkZWxldGVfbWVzc2FnZXMoW21lc3NhZ2UsIG1dKSAKICAgICAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgICAgIGF3YWl0IGVkaXRfY29uZmlnKHZhciwgRmFsc2UpCiAgICAgICAgICAgICAgICBhd2FpdCBtLmVkaXQoZiJTdWNlc3NmdWxseSBkZWxldGVkIHt2YXJ9IikKICAgICAgICAgICAgICAgIGF3YWl0IGRlbGV0ZV9tZXNzYWdlcyhbbWVzc2FnZSwgbV0pICAgICAgICAgICAKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaWYgdmFyIGluIFsiQ0hBVCIsICJMT0dfR1JPVVAiLCAiUkVDT1JESU5HX0RVTVAiLCAiUVVBTElUWSJdOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU9aW50KHZhbHVlKQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgdmFyID09ICJRVUFMSVRZIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIG5vdCB2YWx1ZS5sb3dlcigpIGluIFsibG93IiwgIm1lZGl1bSIsICJoaWdoIl06CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgbS5lZGl0KCJZb3Ugc2hvdWxkIHNwZWNpZnkgYSB2YWx1ZSBiZXR3ZWVuIDEwIC0gMTAwLiIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgZGVsZXRlX21lc3NhZ2VzKFttZXNzYWdlLCBtXSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZS5sb3dlcigpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgdmFsdWUgPT0gImhpZ2giOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IDEwMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsaWYgdmFsdWUgPT0gIm1lZGl1bSI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gNjYuOQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsaWYgdmFsdWUgPT0gImxvdyI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gNTAKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IG0uZWRpdCgiWW91IHNob3VsZCBnaXZlIG1lIGEgY2hhdCBpZCAuIEl0IHNob3VsZCBiZSBhbiBpbnRlcmdlci4iKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgZGVsZXRlX21lc3NhZ2VzKFttZXNzYWdlLCBtXSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICAgICAgICAgIGlmIHZhciA9PSAiQ0hBVCI6CiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGxlYXZlX2NhbGwoKQogICAgICAgICAgICAgICAgICAgICAgICBDb25maWcuQURNSU5fQ0FDSEU9RmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgaWYgQ29uZmlnLklTX1JFQ09SRElORzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHN0b3BfcmVjb3JkaW5nKCkKICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgY2FuY2VsX2FsbF9zY2hlZHVsZXMoKQogICAgICAgICAgICAgICAgICAgICAgICBDb25maWcuQ0hBVD1pbnQodmFsdWUpCiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHJlc3RhcnQoKQogICAgICAgICAgICAgICAgICAgIGF3YWl0IGVkaXRfY29uZmlnKHZhciwgaW50KHZhbHVlKSkKICAgICAgICAgICAgICAgICAgICBpZiB2YXIgPT0gIlFVQUxJVFkiOgogICAgICAgICAgICAgICAgICAgICAgICBpZiBDb25maWcuQ0FMTF9TVEFUVVM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhPUNvbmZpZy5EQVRBLmdldCgnRklMRV9EQVRBJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIG5vdCBkYXRhIFwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvciBkYXRhLmdldCgnZHVyJywgMCkgPT0gMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCByZXN0YXJ0X3BsYXlvdXQoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaywgcmVwbHkgPSBhd2FpdCBzZWVrX2ZpbGUoMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGsgPT0gRmFsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgcmVzdGFydF9wbGF5b3V0KCkKICAgICAgICAgICAgICAgICAgICBhd2FpdCBtLmVkaXQoZiJTdWNjZXNmdWxseSBjaGFuZ2VkIHt2YXJ9IHRvIHt2YWx1ZX0iKQogICAgICAgICAgICAgICAgICAgIGF3YWl0IGRlbGV0ZV9tZXNzYWdlcyhbbWVzc2FnZSwgbV0pCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIGlmIHZhciA9PSAiU1RBUlRVUF9TVFJFQU0iOgogICAgICAgICAgICAgICAgICAgICAgICBDb25maWcuU1RSRUFNX1NFVFVQPUZhbHNlCiAgICAgICAgICAgICAgICAgICAgYXdhaXQgZWRpdF9jb25maWcodmFyLCB2YWx1ZSkKICAgICAgICAgICAgICAgICAgICBhd2FpdCBtLmVkaXQoZiJTdWNjZXNmdWxseSBjaGFuZ2VkIHt2YXJ9IHRvIHt2YWx1ZX0iKQogICAgICAgICAgICAgICAgICAgIGF3YWl0IGRlbGV0ZV9tZXNzYWdlcyhbbWVzc2FnZSwgbV0pCiAgICAgICAgICAgICAgICAgICAgYXdhaXQgcmVzdGFydF9wbGF5b3V0KCkKICAgICAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICBlbHNlOgogICAgICAgICAgICBpZiBub3QgQ29uZmlnLkhFUk9LVV9BUFA6CiAgICAgICAgICAgICAgICBidXR0b25zID0gW1tJbmxpbmVLZXlib2FyZEJ1dHRvbignSGVyb2t1IEFQSV9LRVknLCB1cmw9J2h0dHBzOi8vZGFzaGJvYXJkLmhlcm9rdS5jb20vYWNjb3VudC9hcHBsaWNhdGlvbnMvYXV0aG9yaXphdGlvbnMvbmV3JyksIElubGluZUtleWJvYXJkQnV0dG9uKCfwn5eRIENsb3NlJywgY2FsbGJhY2tfZGF0YT0nY2xvc2UnKSxdXQogICAgICAgICAgICAgICAgYXdhaXQgbS5lZGl0KAogICAgICAgICAgICAgICAgICAgIHRleHQ9Ik5vIGhlcm9rdSBhcHAgZm91bmQsIHRoaXMgY29tbWFuZCBuZWVkcyB0aGUgZm9sbG93aW5nIGhlcm9rdSB2YXJzIHRvIGJlIHNldC5cblxuMS4gPGNvZGU+SEVST0tVX0FQSV9LRVk8L2NvZGU+OiBZb3VyIGhlcm9rdSBhY2NvdW50IGFwaSBrZXkuXG4yLiA8Y29kZT5IRVJPS1VfQVBQX05BTUU8L2NvZGU+OiBZb3VyIGhlcm9rdSBhcHAgbmFtZS4iLCAKICAgICAgICAgICAgICAgICAgICByZXBseV9tYXJrdXA9SW5saW5lS2V5Ym9hcmRNYXJrdXAoYnV0dG9ucykpIAogICAgICAgICAgICAgICAgYXdhaXQgZGVsZXRlX21lc3NhZ2VzKFttZXNzYWdlXSkKICAgICAgICAgICAgICAgIHJldHVybiAgICAgCiAgICAgICAgICAgIGNvbmZpZyA9IENvbmZpZy5IRVJPS1VfQVBQLmNvbmZpZygpCiAgICAgICAgICAgIGlmIG5vdCB2YWx1ZToKICAgICAgICAgICAgICAgIGF3YWl0IG0uZWRpdChmIk5vIHZhbHVlIGZvciBlbnYgc3BlY2lmaWVkLiBUcnlpbmcgdG8gZGVsZXRlIGVudiB7dmFyfS4iKQogICAgICAgICAgICAgICAgYXdhaXQgYXN5bmNpby5zbGVlcCgyKQogICAgICAgICAgICAgICAgaWYgdmFyIGluIFsiU1RBUlRVUF9TVFJFQU0iLCAiQ0hBVCIsICJERUxBWSIsICJBUElfSUQiLCAiQVBJX0hBU0giLCAiQk9UX1RPS0VOIiwgIlNFU1NJT05fU1RSSU5HIiwgIkFETUlOUyJdOgogICAgICAgICAgICAgICAgICAgIGF3YWl0IG0uZWRpdCgiVGhlc2UgYXJlIG1hbmRhdG9yeSB2YXJzIGFuZCBjYW5ub3QgYmUgZGVsZXRlZC4iKQogICAgICAgICAgICAgICAgICAgIGF3YWl0IGRlbGV0ZV9tZXNzYWdlcyhbbWVzc2FnZSwgbV0pCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgICAgICBpZiB2YXIgaW4gY29uZmlnOgogICAgICAgICAgICAgICAgICAgIGF3YWl0IG0uZWRpdChmIlN1Y2Vzc2Z1bGx5IGRlbGV0ZWQge3Zhcn0iKQogICAgICAgICAgICAgICAgICAgIGF3YWl0IGFzeW5jaW8uc2xlZXAoMikKICAgICAgICAgICAgICAgICAgICBhd2FpdCBtLmVkaXQoIk5vdyByZXN0YXJ0aW5nIHRoZSBhcHAgdG8gbWFrZSBjaGFuZ2VzLiIpCiAgICAgICAgICAgICAgICAgICAgaWYgQ29uZmlnLkRBVEFCQVNFX1VSSToKICAgICAgICAgICAgICAgICAgICAgICAgbXNnID0geyJtc2dfaWQiOm0ubWVzc2FnZV9pZCwgImNoYXRfaWQiOm0uY2hhdC5pZH0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgbm90IGF3YWl0IGRiLmlzX3NhdmVkKCJSRVNUQVJUIik6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYi5hZGRfY29uZmlnKCJSRVNUQVJUIiwgbXNnKQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgZGIuZWRpdF9jb25maWcoIlJFU1RBUlQiLCBtc2cpCiAgICAgICAgICAgICAgICAgICAgZGVsIGNvbmZpZ1t2YXJdICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGNvbmZpZ1t2YXJdID0gTm9uZSAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBrID0gYXdhaXQgbS5lZGl0KGYiTm8gZW52IG5hbWVkIHt2YXJ9IGZvdW5kLiBOb3RoaW5nIHdhcyBjaGFuZ2VkLiIpCiAgICAgICAgICAgICAgICAgICAgYXdhaXQgZGVsZXRlX21lc3NhZ2VzKFttZXNzYWdlLCBrXSkKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBpZiB2YXIgaW4gY29uZmlnOgogICAgICAgICAgICAgICAgYXdhaXQgbS5lZGl0KGYiVmFyaWFibGUgYWxyZWFkeSBmb3VuZC4gTm93IGVkaXRlZCB0byB7dmFsdWV9IikKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGF3YWl0IG0uZWRpdChmIlZhcmlhYmxlIG5vdCBmb3VuZCwgTm93IHNldHRpbmcgYXMgbmV3IHZhci4iKQogICAgICAgICAgICBhd2FpdCBhc3luY2lvLnNsZWVwKDIpCiAgICAgICAgICAgIGF3YWl0IG0uZWRpdChmIlN1Y2Nlc2Z1bGx5IHNldCB7dmFyfSB3aXRoIHZhbHVlIHt2YWx1ZX0sIE5vdyBSZXN0YXJ0aW5nIHRvIHRha2UgZWZmZWN0IG9mIGNoYW5nZXMuLi4iKQogICAgICAgICAgICBpZiBDb25maWcuREFUQUJBU0VfVVJJOgogICAgICAgICAgICAgICAgbXNnID0geyJtc2dfaWQiOm0ubWVzc2FnZV9pZCwgImNoYXRfaWQiOm0uY2hhdC5pZH0KICAgICAgICAgICAgICAgIGlmIG5vdCBhd2FpdCBkYi5pc19zYXZlZCgiUkVTVEFSVCIpOgogICAgICAgICAgICAgICAgICAgIGRiLmFkZF9jb25maWcoIlJFU1RBUlQiLCBtc2cpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIGF3YWl0IGRiLmVkaXRfY29uZmlnKCJSRVNUQVJUIiwgbXNnKQogICAgICAgICAgICBjb25maWdbdmFyXSA9IHN0cih2YWx1ZSkKCgoKCg=='))